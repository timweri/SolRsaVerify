// SPDX-License-Identifier: UNLICENSED

pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import "../src/RsaVerifyOptimized.sol";

contract RsaVerifyOptimized_2048_e65537Test is Test {
    function test_rs256_2048_e65537_1() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"398c2bb6efb7f0455c13c2489875cb849cf9e313f8692c919a1674e4f368099598acf4f1714f49696b3d88743bc089dd411b02c50a58dfeed4d56935d62b36c87d8db7c83b983d8fc0f61187e163a943e2afae335c0cca729a49b3a73914e89ac5c73401b9b64455c5f529fa06d139e81bfdd15ddc7473974e1e03fdb3ba26c8";
        bytes memory S = hex"7d9a33780a2fd2656b72ea819a585e490cc28a4a1749bf318b67384a4b5cc04cbe5ea1a054abdf2a30bd913e7fc463d0f88fa66701adf224fb31d2463982a3d438a2ae5f71286b9ed16ce65c08383bf9ccb7342f7ab5ce61bc6cad5be8a158968460d04395fc80eb266d488315d0b6281881bb4c33294806c61cc40cb03f9ae0092c23d81037c98874e5af6709b9a41d8d66db1f57f518224ece6a90cc3d38a1591edc903f77bd641161daf65e7001d1cbacad0dd61e3d22c9b0fb5b24205bd4b2cfea15bdaa63bbc43167e392c4d109899d0e3bf922be957cb70d00941dc663d7355dee7c6d3b92fc500c07920cf1b0faa50846d6efba76cd8688782930dbaf";
        bytes memory n = hex"b17cd47cdcd8af3a69bf741c149fcb251760f750e802a3d598be6aa19347dfcc89831e9a7e03bd8eac8e66848dc0467a96983fd8a6c6ba25b49011f40a866af626ab507ad7234fe8c8050429e48b4fa3233eab1f68a61c5fc74e64b0fe8c701b6d50c9b2f0d701e8324c29f93a98f5dfc33b49e58c68917fc669469de03ea93584a7e4f803579a2578f6a12a1a8fe8729bf293359f69a05f92e0d3ba81020f5fcb0251844a92fefed4704293530a204abc2594ea252336ac59fb18c7cced53667b6f19bae1c571b62c270367f9d4d04e152684d4dafcc9bf378d52d6b7f1600d751cae03aebf1cd1c17851c83b80fbe27b540b7f447a32db36c8c681d3461eed";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), true);
    }
    function test_rs256_2048_e65537_2() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"398c2bb6efb7f0455c13c2489875cb849cf9e313f8692c919a1674e4f368099598acf4f1714f49696b3d88743bc089dd411b02c50a58dfeed4d56935d62b36c87d8db7c83b983d8fc0f61187e163a943e2afae335c0cca729a49b3a73914e89ac5c73401b9b64455c5f529fa06d139e81bfdd15ddc7473974e1e03fdb3ba26c8";
        bytes memory S = hex"829a33780a2fd2656b72ea819a585e490cc28a4a1749bf318b67384a4b5cc04cbe5ea1a054abdf2a30bd913e7fc463d0f88fa66701adf224fb31d2463982a3d438a2ae5f71286b9ed16ce65c08383bf9ccb7342f7ab5ce61bc6cad5be8a158968460d04395fc80eb266d488315d0b6281881bb4c33294806c61cc40cb03f9ae0092c23d81037c98874e5af6709b9a41d8d66db1f57f518224ece6a90cc3d38a1591edc903f77bd641161daf65e7001d1cbacad0dd61e3d22c9b0fb5b24205bd4b2cfea15bdaa63bbc43167e392c4d109899d0e3bf922be957cb70d00941dc663d7355dee7c6d3b92fc500c07920cf1b0faa50846d6efba76cd8688782930dbaf";
        bytes memory n = hex"b17cd47cdcd8af3a69bf741c149fcb251760f750e802a3d598be6aa19347dfcc89831e9a7e03bd8eac8e66848dc0467a96983fd8a6c6ba25b49011f40a866af626ab507ad7234fe8c8050429e48b4fa3233eab1f68a61c5fc74e64b0fe8c701b6d50c9b2f0d701e8324c29f93a98f5dfc33b49e58c68917fc669469de03ea93584a7e4f803579a2578f6a12a1a8fe8729bf293359f69a05f92e0d3ba81020f5fcb0251844a92fefed4704293530a204abc2594ea252336ac59fb18c7cced53667b6f19bae1c571b62c270367f9d4d04e152684d4dafcc9bf378d52d6b7f1600d751cae03aebf1cd1c17851c83b80fbe27b540b7f447a32db36c8c681d3461eed";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), false);
    }
    function test_rs256_2048_e65537_3() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"0ec99fe90f3c2e4dd49eada5fc071367930df126d39657aa466aeafc5665f9a5a584ce0f694f3d63d1a87427167d868f0fd0362b36e61ac2d1c51d2ba63acf52e00381aa5e354d954cb1fcc9702ae2328ed205dd0b9caf4cb2f679b9f307b2e48f29b1a886579d4a7a85ee32bebd733ecbcf4e6068edff23931f9d74229bd6c5";
        bytes memory S = hex"84cdf1e5934bc2347474b6e14d8fec52935f9105cda715a23ee02478733db74c91661d52013834ce702b471c95fea983b95569fa4e29b5a6a6e785953887a211b2526caade512579254cb4c0277659f2864b643f1baa412f38b728e5d68057ff1ee9e9a74b0fb7b8469bbb3828fa89468da618958a2f5c59d35822d44fb6a78a8ceb553723818751198e609bebeddfe18e864ca940cea8cd012929b1a4fe86cbd606156f630e72fb4720096232620e68b9731e4a7ac0efb72ebc1f700d7cf9bc66f53cf6780918f013f79df168ebe97a1b9bd4d84de2d26523449ea614d4dc86ebeaa0d1a5cd3da0880430a2241673ce7c9bb64084adde81e4d3c86936f3456d";
        bytes memory n = hex"b17cd47cdcd8af3a69bf741c149fcb251760f750e802a3d598be6aa19347dfcc89831e9a7e03bd8eac8e66848dc0467a96983fd8a6c6ba25b49011f40a866af626ab507ad7234fe8c8050429e48b4fa3233eab1f68a61c5fc74e64b0fe8c701b6d50c9b2f0d701e8324c29f93a98f5dfc33b49e58c68917fc669469de03ea93584a7e4f803579a2578f6a12a1a8fe8729bf293359f69a05f92e0d3ba81020f5fcb0251844a92fefed4704293530a204abc2594ea252336ac59fb18c7cced53667b6f19bae1c571b62c270367f9d4d04e152684d4dafcc9bf378d52d6b7f1600d751cae03aebf1cd1c17851c83b80fbe27b540b7f447a32db36c8c681d3461eed";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), true);
    }
    function test_rs256_2048_e65537_4() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"0ec99fe90f3c2e4dd49eada5fc071367930df126d39657aa466aeafc5665f9a5a584ce0f694f3d63d1a87427167d868f0fd0362b36e61ac2d1c51d2ba63acf52e00381aa5e354d954cb1fcc9702ae2328ed205dd0b9caf4cb2f679b9f307b2e48f29b1a886579d4a7a85ee32bebd733ecbcf4e6068edff23931f9d74229bd6c5";
        bytes memory S = hex"7bcdf1e5934bc2347474b6e14d8fec52935f9105cda715a23ee02478733db74c91661d52013834ce702b471c95fea983b95569fa4e29b5a6a6e785953887a211b2526caade512579254cb4c0277659f2864b643f1baa412f38b728e5d68057ff1ee9e9a74b0fb7b8469bbb3828fa89468da618958a2f5c59d35822d44fb6a78a8ceb553723818751198e609bebeddfe18e864ca940cea8cd012929b1a4fe86cbd606156f630e72fb4720096232620e68b9731e4a7ac0efb72ebc1f700d7cf9bc66f53cf6780918f013f79df168ebe97a1b9bd4d84de2d26523449ea614d4dc86ebeaa0d1a5cd3da0880430a2241673ce7c9bb64084adde81e4d3c86936f3456d";
        bytes memory n = hex"b17cd47cdcd8af3a69bf741c149fcb251760f750e802a3d598be6aa19347dfcc89831e9a7e03bd8eac8e66848dc0467a96983fd8a6c6ba25b49011f40a866af626ab507ad7234fe8c8050429e48b4fa3233eab1f68a61c5fc74e64b0fe8c701b6d50c9b2f0d701e8324c29f93a98f5dfc33b49e58c68917fc669469de03ea93584a7e4f803579a2578f6a12a1a8fe8729bf293359f69a05f92e0d3ba81020f5fcb0251844a92fefed4704293530a204abc2594ea252336ac59fb18c7cced53667b6f19bae1c571b62c270367f9d4d04e152684d4dafcc9bf378d52d6b7f1600d751cae03aebf1cd1c17851c83b80fbe27b540b7f447a32db36c8c681d3461eed";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), false);
    }
    function test_rs256_2048_e65537_5() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"94673f08882f03202fc74f27d555226f3f389967c7f30f6c7f299663e5a8306abc834fb5e1f6e9e83b9be3149472b91332d9275105f2e7731ddd1c7e796193ecb6cfd9787c5fa05514fc59a77d209568d12ffc17148afa61e4311e08a6e740c4a1a4ba80fa2207429a8a711176417ab1d5ca75d6c6112bf2800950dd0987aa27";
        bytes memory S = hex"1d875934d15aae5ad17f4ee458e9f83dd0e61865a501b02097de17323a45f2cd56474c116f844f60799887d8fda317aa2073e8fbd1a90a18fe7c4f5f55a4f6cd94e97e7504bb0d41ef2207990e78d3fc1f0562908fb431671f8e1f692303cd2c1ef42a2f17445e9115c94cbd7650152d1f05f8e84f119845c21d830ac0904830f5c3e7a254ceae958d4da6b142af0c1db5857a716afab48fa4fcd5ad8b7e5ebf3d8d81b74a3fe08f3825d8b748bc0b977b53abbe69c50cbc9301d9c4407a92e252661551af6a09e31a1862ace86f5da4335fc966cec14917b80b9e5c3f2b203fa775483c3e2a8df07ce69eb12ab89802b550dab2ad9057f2be61a838036e33d0";
        bytes memory n = hex"b17cd47cdcd8af3a69bf741c149fcb251760f750e802a3d598be6aa19347dfcc89831e9a7e03bd8eac8e66848dc0467a96983fd8a6c6ba25b49011f40a866af626ab507ad7234fe8c8050429e48b4fa3233eab1f68a61c5fc74e64b0fe8c701b6d50c9b2f0d701e8324c29f93a98f5dfc33b49e58c68917fc669469de03ea93584a7e4f803579a2578f6a12a1a8fe8729bf293359f69a05f92e0d3ba81020f5fcb0251844a92fefed4704293530a204abc2594ea252336ac59fb18c7cced53667b6f19bae1c571b62c270367f9d4d04e152684d4dafcc9bf378d52d6b7f1600d751cae03aebf1cd1c17851c83b80fbe27b540b7f447a32db36c8c681d3461eed";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), true);
    }
    function test_rs256_2048_e65537_6() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"94673f08882f03202fc74f27d555226f3f389967c7f30f6c7f299663e5a8306abc834fb5e1f6e9e83b9be3149472b91332d9275105f2e7731ddd1c7e796193ecb6cfd9787c5fa05514fc59a77d209568d12ffc17148afa61e4311e08a6e740c4a1a4ba80fa2207429a8a711176417ab1d5ca75d6c6112bf2800950dd0987aa27";
        bytes memory S = hex"e2875934d15aae5ad17f4ee458e9f83dd0e61865a501b02097de17323a45f2cd56474c116f844f60799887d8fda317aa2073e8fbd1a90a18fe7c4f5f55a4f6cd94e97e7504bb0d41ef2207990e78d3fc1f0562908fb431671f8e1f692303cd2c1ef42a2f17445e9115c94cbd7650152d1f05f8e84f119845c21d830ac0904830f5c3e7a254ceae958d4da6b142af0c1db5857a716afab48fa4fcd5ad8b7e5ebf3d8d81b74a3fe08f3825d8b748bc0b977b53abbe69c50cbc9301d9c4407a92e252661551af6a09e31a1862ace86f5da4335fc966cec14917b80b9e5c3f2b203fa775483c3e2a8df07ce69eb12ab89802b550dab2ad9057f2be61a838036e33d0";
        bytes memory n = hex"b17cd47cdcd8af3a69bf741c149fcb251760f750e802a3d598be6aa19347dfcc89831e9a7e03bd8eac8e66848dc0467a96983fd8a6c6ba25b49011f40a866af626ab507ad7234fe8c8050429e48b4fa3233eab1f68a61c5fc74e64b0fe8c701b6d50c9b2f0d701e8324c29f93a98f5dfc33b49e58c68917fc669469de03ea93584a7e4f803579a2578f6a12a1a8fe8729bf293359f69a05f92e0d3ba81020f5fcb0251844a92fefed4704293530a204abc2594ea252336ac59fb18c7cced53667b6f19bae1c571b62c270367f9d4d04e152684d4dafcc9bf378d52d6b7f1600d751cae03aebf1cd1c17851c83b80fbe27b540b7f447a32db36c8c681d3461eed";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), false);
    }
    function test_rs256_2048_e65537_7() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"8391321c3e89d775f72744bde2b75037dc5005cb75db4664b076cade2cb640027c0c27ee26b3112d3b990d33ecdab4f1d48dbb0f01937cbdfcf91baf03b7ea1b2440e852d8282e8a612d710a748ff7edb23c4f4d47039498a96f5009ac59ec6cd8427e597b102562a9fb3fca0aabd11267639c87c926c261377403e182e17646";
        bytes memory S = hex"934d3debc209b84bfd2de982cd494bd288ee2af2ebe9c7999bbac132e6c2f0c0b13ca2bf59b67a7de8064fa1de2e541abe882033c4198bd815a8f824c527b6478634c5e546eb154d699bba19fd7acdf0fb21bddce224e7cf3f41f941c0e12b8f85cb68898b4f4b3e1c1af242e3cb525a85ce21d0dc4fddd69301f6bfe59eaf33b1ceeb308ed725dd4971a0dbb6485adfc3a50d7683bca39aba75479496cbe38cd7e669fca349d52f53f9f5cf360618c1e65cf00675d328d19b79cae73b9e7ada2959897cc1ded2832c6bab9049a37523fb42bf74bc73f63c3ed77d724d6ed5d055cfd8ab50ee8afd16d002681dbd7e4865c019776c1f6903b9b7675d357a10be";
        bytes memory n = hex"b17cd47cdcd8af3a69bf741c149fcb251760f750e802a3d598be6aa19347dfcc89831e9a7e03bd8eac8e66848dc0467a96983fd8a6c6ba25b49011f40a866af626ab507ad7234fe8c8050429e48b4fa3233eab1f68a61c5fc74e64b0fe8c701b6d50c9b2f0d701e8324c29f93a98f5dfc33b49e58c68917fc669469de03ea93584a7e4f803579a2578f6a12a1a8fe8729bf293359f69a05f92e0d3ba81020f5fcb0251844a92fefed4704293530a204abc2594ea252336ac59fb18c7cced53667b6f19bae1c571b62c270367f9d4d04e152684d4dafcc9bf378d52d6b7f1600d751cae03aebf1cd1c17851c83b80fbe27b540b7f447a32db36c8c681d3461eed";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), true);
    }
    function test_rs256_2048_e65537_8() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"8391321c3e89d775f72744bde2b75037dc5005cb75db4664b076cade2cb640027c0c27ee26b3112d3b990d33ecdab4f1d48dbb0f01937cbdfcf91baf03b7ea1b2440e852d8282e8a612d710a748ff7edb23c4f4d47039498a96f5009ac59ec6cd8427e597b102562a9fb3fca0aabd11267639c87c926c261377403e182e17646";
        bytes memory S = hex"6c4d3debc209b84bfd2de982cd494bd288ee2af2ebe9c7999bbac132e6c2f0c0b13ca2bf59b67a7de8064fa1de2e541abe882033c4198bd815a8f824c527b6478634c5e546eb154d699bba19fd7acdf0fb21bddce224e7cf3f41f941c0e12b8f85cb68898b4f4b3e1c1af242e3cb525a85ce21d0dc4fddd69301f6bfe59eaf33b1ceeb308ed725dd4971a0dbb6485adfc3a50d7683bca39aba75479496cbe38cd7e669fca349d52f53f9f5cf360618c1e65cf00675d328d19b79cae73b9e7ada2959897cc1ded2832c6bab9049a37523fb42bf74bc73f63c3ed77d724d6ed5d055cfd8ab50ee8afd16d002681dbd7e4865c019776c1f6903b9b7675d357a10be";
        bytes memory n = hex"b17cd47cdcd8af3a69bf741c149fcb251760f750e802a3d598be6aa19347dfcc89831e9a7e03bd8eac8e66848dc0467a96983fd8a6c6ba25b49011f40a866af626ab507ad7234fe8c8050429e48b4fa3233eab1f68a61c5fc74e64b0fe8c701b6d50c9b2f0d701e8324c29f93a98f5dfc33b49e58c68917fc669469de03ea93584a7e4f803579a2578f6a12a1a8fe8729bf293359f69a05f92e0d3ba81020f5fcb0251844a92fefed4704293530a204abc2594ea252336ac59fb18c7cced53667b6f19bae1c571b62c270367f9d4d04e152684d4dafcc9bf378d52d6b7f1600d751cae03aebf1cd1c17851c83b80fbe27b540b7f447a32db36c8c681d3461eed";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), false);
    }
    function test_rs256_2048_e65537_9() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"69938f4f4baea2cc778636e2431284e76c9b7e670e1e320607396af27fe4c822edaeacf2acd0293aadedb695a181d2b2fcd52ed14c650c04c9272a34b21c566df5e07950e889c53acfb1c241318cadf54ed39ca20ffb6a19be4e9ddca7c4a28bd55f0638834f035002b2754c37a3188b31b0f4b8286304e63c3364c955521068";
        bytes memory S = hex"9e5d61915d2d3e70e3c4cb5631ad3b8ce01d3726a0df43aba02f4dc84506402595047ce45c7610512896b3deb3e49fcb85f951a6ee0227e6a20e124b3e51eb41298ff24e522125b8fbdc4b40b8ca74e2b6de640c89ba73424a1c8cd497e10db8560746c44cb7e357b0fd51194f5a1cedd83c09adc70caae60dbba75a60c65a7dbf9420e5b2554c020ac44177bb66c1b50be0d7b95cf8a27c742c43d00c6547962289797c2d0f89a825af7fbe6b2649d65f2d566a87671e19ef0f128bee25437cc015dc8eddd2b262cd1dda9600a0d5f3f029c2b6dd8df026d60b75fa8d297c0cfc7f76e81d9c11991625dd6802eb9143f6f0919aa9bdf990802c3afb5ee11f4c";
        bytes memory n = hex"b17cd47cdcd8af3a69bf741c149fcb251760f750e802a3d598be6aa19347dfcc89831e9a7e03bd8eac8e66848dc0467a96983fd8a6c6ba25b49011f40a866af626ab507ad7234fe8c8050429e48b4fa3233eab1f68a61c5fc74e64b0fe8c701b6d50c9b2f0d701e8324c29f93a98f5dfc33b49e58c68917fc669469de03ea93584a7e4f803579a2578f6a12a1a8fe8729bf293359f69a05f92e0d3ba81020f5fcb0251844a92fefed4704293530a204abc2594ea252336ac59fb18c7cced53667b6f19bae1c571b62c270367f9d4d04e152684d4dafcc9bf378d52d6b7f1600d751cae03aebf1cd1c17851c83b80fbe27b540b7f447a32db36c8c681d3461eed";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), true);
    }
    function test_rs256_2048_e65537_10() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"69938f4f4baea2cc778636e2431284e76c9b7e670e1e320607396af27fe4c822edaeacf2acd0293aadedb695a181d2b2fcd52ed14c650c04c9272a34b21c566df5e07950e889c53acfb1c241318cadf54ed39ca20ffb6a19be4e9ddca7c4a28bd55f0638834f035002b2754c37a3188b31b0f4b8286304e63c3364c955521068";
        bytes memory S = hex"615d61915d2d3e70e3c4cb5631ad3b8ce01d3726a0df43aba02f4dc84506402595047ce45c7610512896b3deb3e49fcb85f951a6ee0227e6a20e124b3e51eb41298ff24e522125b8fbdc4b40b8ca74e2b6de640c89ba73424a1c8cd497e10db8560746c44cb7e357b0fd51194f5a1cedd83c09adc70caae60dbba75a60c65a7dbf9420e5b2554c020ac44177bb66c1b50be0d7b95cf8a27c742c43d00c6547962289797c2d0f89a825af7fbe6b2649d65f2d566a87671e19ef0f128bee25437cc015dc8eddd2b262cd1dda9600a0d5f3f029c2b6dd8df026d60b75fa8d297c0cfc7f76e81d9c11991625dd6802eb9143f6f0919aa9bdf990802c3afb5ee11f4c";
        bytes memory n = hex"b17cd47cdcd8af3a69bf741c149fcb251760f750e802a3d598be6aa19347dfcc89831e9a7e03bd8eac8e66848dc0467a96983fd8a6c6ba25b49011f40a866af626ab507ad7234fe8c8050429e48b4fa3233eab1f68a61c5fc74e64b0fe8c701b6d50c9b2f0d701e8324c29f93a98f5dfc33b49e58c68917fc669469de03ea93584a7e4f803579a2578f6a12a1a8fe8729bf293359f69a05f92e0d3ba81020f5fcb0251844a92fefed4704293530a204abc2594ea252336ac59fb18c7cced53667b6f19bae1c571b62c270367f9d4d04e152684d4dafcc9bf378d52d6b7f1600d751cae03aebf1cd1c17851c83b80fbe27b540b7f447a32db36c8c681d3461eed";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), false);
    }
}