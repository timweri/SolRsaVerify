// SPDX-License-Identifier: UNLICENSED

pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import "../src/RsaVerifyOptimized.sol";

contract RsaVerifyOptimized_4096_e65537Test is Test {
    function test_rs256_4096_e65537_1() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"398c2bb6efb7f0455c13c2489875cb849cf9e313f8692c919a1674e4f368099598acf4f1714f49696b3d88743bc089dd411b02c50a58dfeed4d56935d62b36c87d8db7c83b983d8fc0f61187e163a943e2afae335c0cca729a49b3a73914e89ac5c73401b9b64455c5f529fa06d139e81bfdd15ddc7473974e1e03fdb3ba26c8";
        bytes memory S = hex"923cd096b0360326e9e4e8f80340ab9e8f134327da3ecb375c221fdfd7aa6f88fd851c6c6fc31c95b609ec9e46846903b17af2b19d2ed783671995eb786e724f9f3dffcd54405ed655f4b4d1826eac53c1200278826235f5acf45d1982d68d1443561c0a23f706927f82e4599590bc0741f45fe657c403d3d1a82169a4e094491d6a5a4ce3d693d713adf17e3de107474d0babf23ea7c5b991307fd8d4fe2f5829663bbf393eb73cf0483d9330847ba0274b5a878353edb99e22c8df47099dfa40a7c109408962a51d287639a2c0f52ca4d52b275b47b8ff6c24667b7d92ee75b13dcf8a1bbf70c601761f8f8dbf444aa01082d3cd1a7ddf627397a2f1b895be5a42cf1c654683046d0feae310ed782e2cae7dcfd8d07e3972e04afd02ad34fa1f9795e33e969e89a80aed44423d4be41cec1cba5dfa08cc64bdd29072199183dd0fbf9d0b988b2c9d70a04b1bf88035d77bd0b6890c46a183aceb21543c58da437aec1131786113f6533bae4e8393626ce99b90fe3d664a523c867a672a8d62ddc7e57fa4b91dbfdd2c01bc2a9ac519d606a1382a63e9d93dfff6996aa6e6c1242d542c89c4eacdc21e8b103ad8fd59fbfb4c2273e4030568b965c29be6758d95aca6851e1ab40e2655ca6d99f0776e259be3b51232864d4bf29a15a3f355f1d4469f4f48055f980df85809cad2889990cf9e585b83fd6d70688101f6e3b63b";
        bytes memory n = hex"b8d3d58b035508e4c6f1f1ee322253875ce74159f4e2d0e3ae4bca0635fae74ac5ebe0a8fd161dda64ba072ff7b1bdd9b8979ae0b1c2e702c3fe08a5a4f3b2ea6502e483c1144452f4a6fcdce08c5b3c2a495ec5892f717adb6bb13e2293a744764f885399700b5026dd8b94bf1c9cb608f9a6aa14e536df0156a54d88daa2e6722ef0c2d9ad6eca9618ca8526db102abfa5ce556a2250fb4700f82f2369cebf14d60cdb2ea71ecae84470c90547aba4b5c7908da25f588eccc5eb50c4d8241700660c3d3878a34d73d962b13e495eb222ca69ebf614526b9712052ac3270bd5a364d06165a519b1096bcb7c694dca0b6fc9dafa624085a0f270b456d9fb88f57e0a9dedc5ab763b216478542f6cef01d35bdcfff8d50a45c044da5b56e113f83e3d644c6a849265bf0f76feff11709dc1da930c76dbd673d3d3bd7deb02cc0f84e46e5b0ee209c26fe0314c12471696b7f56e9b683425dbc0bf819798c415f2bc11ae8341c28b2fa971482c2bdcf274dd7f42cdeb8e0087513c8a08e763d07e081e8361815c4bb86c58f1164ff592019d866f88d26c173b2385ef14ae700e38460dcdf90560c7fa86aa2df9f4fae995f6b6e5750a24c45300b0c700f61fcf7cb021aef8465f627320224c407f4ad61b559b9bb0a77966ec321a2df28ddd9191af7bd398bbf07d3688c11c0f8e95b043286ef1f6fd5b3e909f89181476aea891";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), true);
    }
    function test_rs256_4096_e65537_2() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"398c2bb6efb7f0455c13c2489875cb849cf9e313f8692c919a1674e4f368099598acf4f1714f49696b3d88743bc089dd411b02c50a58dfeed4d56935d62b36c87d8db7c83b983d8fc0f61187e163a943e2afae335c0cca729a49b3a73914e89ac5c73401b9b64455c5f529fa06d139e81bfdd15ddc7473974e1e03fdb3ba26c8";
        bytes memory S = hex"6d3cd096b0360326e9e4e8f80340ab9e8f134327da3ecb375c221fdfd7aa6f88fd851c6c6fc31c95b609ec9e46846903b17af2b19d2ed783671995eb786e724f9f3dffcd54405ed655f4b4d1826eac53c1200278826235f5acf45d1982d68d1443561c0a23f706927f82e4599590bc0741f45fe657c403d3d1a82169a4e094491d6a5a4ce3d693d713adf17e3de107474d0babf23ea7c5b991307fd8d4fe2f5829663bbf393eb73cf0483d9330847ba0274b5a878353edb99e22c8df47099dfa40a7c109408962a51d287639a2c0f52ca4d52b275b47b8ff6c24667b7d92ee75b13dcf8a1bbf70c601761f8f8dbf444aa01082d3cd1a7ddf627397a2f1b895be5a42cf1c654683046d0feae310ed782e2cae7dcfd8d07e3972e04afd02ad34fa1f9795e33e969e89a80aed44423d4be41cec1cba5dfa08cc64bdd29072199183dd0fbf9d0b988b2c9d70a04b1bf88035d77bd0b6890c46a183aceb21543c58da437aec1131786113f6533bae4e8393626ce99b90fe3d664a523c867a672a8d62ddc7e57fa4b91dbfdd2c01bc2a9ac519d606a1382a63e9d93dfff6996aa6e6c1242d542c89c4eacdc21e8b103ad8fd59fbfb4c2273e4030568b965c29be6758d95aca6851e1ab40e2655ca6d99f0776e259be3b51232864d4bf29a15a3f355f1d4469f4f48055f980df85809cad2889990cf9e585b83fd6d70688101f6e3b63b";
        bytes memory n = hex"b8d3d58b035508e4c6f1f1ee322253875ce74159f4e2d0e3ae4bca0635fae74ac5ebe0a8fd161dda64ba072ff7b1bdd9b8979ae0b1c2e702c3fe08a5a4f3b2ea6502e483c1144452f4a6fcdce08c5b3c2a495ec5892f717adb6bb13e2293a744764f885399700b5026dd8b94bf1c9cb608f9a6aa14e536df0156a54d88daa2e6722ef0c2d9ad6eca9618ca8526db102abfa5ce556a2250fb4700f82f2369cebf14d60cdb2ea71ecae84470c90547aba4b5c7908da25f588eccc5eb50c4d8241700660c3d3878a34d73d962b13e495eb222ca69ebf614526b9712052ac3270bd5a364d06165a519b1096bcb7c694dca0b6fc9dafa624085a0f270b456d9fb88f57e0a9dedc5ab763b216478542f6cef01d35bdcfff8d50a45c044da5b56e113f83e3d644c6a849265bf0f76feff11709dc1da930c76dbd673d3d3bd7deb02cc0f84e46e5b0ee209c26fe0314c12471696b7f56e9b683425dbc0bf819798c415f2bc11ae8341c28b2fa971482c2bdcf274dd7f42cdeb8e0087513c8a08e763d07e081e8361815c4bb86c58f1164ff592019d866f88d26c173b2385ef14ae700e38460dcdf90560c7fa86aa2df9f4fae995f6b6e5750a24c45300b0c700f61fcf7cb021aef8465f627320224c407f4ad61b559b9bb0a77966ec321a2df28ddd9191af7bd398bbf07d3688c11c0f8e95b043286ef1f6fd5b3e909f89181476aea891";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), false);
    }
    function test_rs256_4096_e65537_3() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"0ec99fe90f3c2e4dd49eada5fc071367930df126d39657aa466aeafc5665f9a5a584ce0f694f3d63d1a87427167d868f0fd0362b36e61ac2d1c51d2ba63acf52e00381aa5e354d954cb1fcc9702ae2328ed205dd0b9caf4cb2f679b9f307b2e48f29b1a886579d4a7a85ee32bebd733ecbcf4e6068edff23931f9d74229bd6c5";
        bytes memory S = hex"041ce89b2d06cd8930ccb4140f3f6b1e073199136288b14cd4165ad92dc90c1e4d61bd4b874fb355022e508ff7d5942e9d74928febe68a5a9ac5e52a67ac655382252e7a3b917300f2476640fb851dd2ab656c6b4a4b01f786a17bae3b8caef0c3a8ca26a0601b97e240b0df1ae217d7980938a0ab1cc02873382646954234c4d9286d691db97dabf73eda62e3d5102c8a19b0ac05d4b2a0925b6fef6dc4c06096fe0d0bc20a31f0333af84ab813f20c8583a30cbf8dcfa6446b40a51f596cc4057bebb4dd7d7490f161bf031f6b10a12c32024e0644c3914991ad39d8c865b92bd4af0e9af09141c9805d6362eb10ed2597391b81854e368ad0a5e7a12bea967b110cfe599b84a48cc0bd298a793fd8be6a23d6da01e6c05f0a7b6803c26580b0952398661547b444a597493bedd7e407751ac575656b62c41d59c04e1eb6c8c95049d42422f1e2b61837e59e00e093c794760071b7e9d0401442d6ce10e53a37a87754fdaf4904aba13cc5be32b67a12cca75ebd96dc48f9010ccbe088b4f1501978ffe6eca8f2a5bf49f6493a9cc765383c4b179e7da9b40a0ff73aa6334a1beb87b055cf712da74b812042e261c16bbaf6ab9103a0d1a2936b0fba5fa640891a93b7967c68d2fdc94d5a3a5a9c58613412d4108297a690f9190cde3eca547926240b3232170ea271302929397d1c5ea1b3afc3547b4c1b87461ed96a3c96";
        bytes memory n = hex"b8d3d58b035508e4c6f1f1ee322253875ce74159f4e2d0e3ae4bca0635fae74ac5ebe0a8fd161dda64ba072ff7b1bdd9b8979ae0b1c2e702c3fe08a5a4f3b2ea6502e483c1144452f4a6fcdce08c5b3c2a495ec5892f717adb6bb13e2293a744764f885399700b5026dd8b94bf1c9cb608f9a6aa14e536df0156a54d88daa2e6722ef0c2d9ad6eca9618ca8526db102abfa5ce556a2250fb4700f82f2369cebf14d60cdb2ea71ecae84470c90547aba4b5c7908da25f588eccc5eb50c4d8241700660c3d3878a34d73d962b13e495eb222ca69ebf614526b9712052ac3270bd5a364d06165a519b1096bcb7c694dca0b6fc9dafa624085a0f270b456d9fb88f57e0a9dedc5ab763b216478542f6cef01d35bdcfff8d50a45c044da5b56e113f83e3d644c6a849265bf0f76feff11709dc1da930c76dbd673d3d3bd7deb02cc0f84e46e5b0ee209c26fe0314c12471696b7f56e9b683425dbc0bf819798c415f2bc11ae8341c28b2fa971482c2bdcf274dd7f42cdeb8e0087513c8a08e763d07e081e8361815c4bb86c58f1164ff592019d866f88d26c173b2385ef14ae700e38460dcdf90560c7fa86aa2df9f4fae995f6b6e5750a24c45300b0c700f61fcf7cb021aef8465f627320224c407f4ad61b559b9bb0a77966ec321a2df28ddd9191af7bd398bbf07d3688c11c0f8e95b043286ef1f6fd5b3e909f89181476aea891";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), true);
    }
    function test_rs256_4096_e65537_4() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"0ec99fe90f3c2e4dd49eada5fc071367930df126d39657aa466aeafc5665f9a5a584ce0f694f3d63d1a87427167d868f0fd0362b36e61ac2d1c51d2ba63acf52e00381aa5e354d954cb1fcc9702ae2328ed205dd0b9caf4cb2f679b9f307b2e48f29b1a886579d4a7a85ee32bebd733ecbcf4e6068edff23931f9d74229bd6c5";
        bytes memory S = hex"fb1ce89b2d06cd8930ccb4140f3f6b1e073199136288b14cd4165ad92dc90c1e4d61bd4b874fb355022e508ff7d5942e9d74928febe68a5a9ac5e52a67ac655382252e7a3b917300f2476640fb851dd2ab656c6b4a4b01f786a17bae3b8caef0c3a8ca26a0601b97e240b0df1ae217d7980938a0ab1cc02873382646954234c4d9286d691db97dabf73eda62e3d5102c8a19b0ac05d4b2a0925b6fef6dc4c06096fe0d0bc20a31f0333af84ab813f20c8583a30cbf8dcfa6446b40a51f596cc4057bebb4dd7d7490f161bf031f6b10a12c32024e0644c3914991ad39d8c865b92bd4af0e9af09141c9805d6362eb10ed2597391b81854e368ad0a5e7a12bea967b110cfe599b84a48cc0bd298a793fd8be6a23d6da01e6c05f0a7b6803c26580b0952398661547b444a597493bedd7e407751ac575656b62c41d59c04e1eb6c8c95049d42422f1e2b61837e59e00e093c794760071b7e9d0401442d6ce10e53a37a87754fdaf4904aba13cc5be32b67a12cca75ebd96dc48f9010ccbe088b4f1501978ffe6eca8f2a5bf49f6493a9cc765383c4b179e7da9b40a0ff73aa6334a1beb87b055cf712da74b812042e261c16bbaf6ab9103a0d1a2936b0fba5fa640891a93b7967c68d2fdc94d5a3a5a9c58613412d4108297a690f9190cde3eca547926240b3232170ea271302929397d1c5ea1b3afc3547b4c1b87461ed96a3c96";
        bytes memory n = hex"b8d3d58b035508e4c6f1f1ee322253875ce74159f4e2d0e3ae4bca0635fae74ac5ebe0a8fd161dda64ba072ff7b1bdd9b8979ae0b1c2e702c3fe08a5a4f3b2ea6502e483c1144452f4a6fcdce08c5b3c2a495ec5892f717adb6bb13e2293a744764f885399700b5026dd8b94bf1c9cb608f9a6aa14e536df0156a54d88daa2e6722ef0c2d9ad6eca9618ca8526db102abfa5ce556a2250fb4700f82f2369cebf14d60cdb2ea71ecae84470c90547aba4b5c7908da25f588eccc5eb50c4d8241700660c3d3878a34d73d962b13e495eb222ca69ebf614526b9712052ac3270bd5a364d06165a519b1096bcb7c694dca0b6fc9dafa624085a0f270b456d9fb88f57e0a9dedc5ab763b216478542f6cef01d35bdcfff8d50a45c044da5b56e113f83e3d644c6a849265bf0f76feff11709dc1da930c76dbd673d3d3bd7deb02cc0f84e46e5b0ee209c26fe0314c12471696b7f56e9b683425dbc0bf819798c415f2bc11ae8341c28b2fa971482c2bdcf274dd7f42cdeb8e0087513c8a08e763d07e081e8361815c4bb86c58f1164ff592019d866f88d26c173b2385ef14ae700e38460dcdf90560c7fa86aa2df9f4fae995f6b6e5750a24c45300b0c700f61fcf7cb021aef8465f627320224c407f4ad61b559b9bb0a77966ec321a2df28ddd9191af7bd398bbf07d3688c11c0f8e95b043286ef1f6fd5b3e909f89181476aea891";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), false);
    }
    function test_rs256_4096_e65537_5() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"94673f08882f03202fc74f27d555226f3f389967c7f30f6c7f299663e5a8306abc834fb5e1f6e9e83b9be3149472b91332d9275105f2e7731ddd1c7e796193ecb6cfd9787c5fa05514fc59a77d209568d12ffc17148afa61e4311e08a6e740c4a1a4ba80fa2207429a8a711176417ab1d5ca75d6c6112bf2800950dd0987aa27";
        bytes memory S = hex"8ec315c21b8089087f695dbbab7d02c3000bfee575d922f233d718f86106bbe580953d28c573d848bf90b3e6646840e6f278f1da94223b968aa09911ee5ecf7467a1aaf7ebdcc69a97374ef80e7555989e4638c5fdc542c332d5b8ff1dd4d0e874c3b74f39fe589e190c1ad0b4ad84794ce6d741a2b76e393affff72c7a647ea9c99845871fba0814fa66514374f3b4583338ba51fcded70a39ad46659993bf3cd8ba2f92f624a5ed44e99059d1d0c4939aea8fafaf6783d281ab94ee182e63f81487b522e8bd7f5ac501626c15139bb69d4a6d221318c6b714fef2e2f1fcb7dfc63c406744f7c1f28693dfae5cead201885f47433491359af614a5d21233f8d3551549cfaeaa10998a7848be798abb89b338313ee4679afaa494933d73b08fa836036c8d7a463932b27653ca614a225aa97879f9c14a8fcca9532d1f484fe937e8936ad0c239880ca288e670cf88b29bad52bfdebfb7aa471275d7ad5d9689b742d63b9889f97f499b12578eae51f69aeddf580fb9314a93e976d4591f44a07e727f32b58852115e8e56c7ce8ae522b004c2d084b5c0477500937a13b012be15927fe66592add9ae02e2997c69beb175f368279a20d7cc9e5ffc15154ce8d59036bb2b978f842aa6d69aad64b4bddc6c56281d05e83b3a49115fe0632021895885ef6d0864ddca8cfea8c4f4a37f29c4a4847452dc89001ca6f47fb356043b2";
        bytes memory n = hex"b8d3d58b035508e4c6f1f1ee322253875ce74159f4e2d0e3ae4bca0635fae74ac5ebe0a8fd161dda64ba072ff7b1bdd9b8979ae0b1c2e702c3fe08a5a4f3b2ea6502e483c1144452f4a6fcdce08c5b3c2a495ec5892f717adb6bb13e2293a744764f885399700b5026dd8b94bf1c9cb608f9a6aa14e536df0156a54d88daa2e6722ef0c2d9ad6eca9618ca8526db102abfa5ce556a2250fb4700f82f2369cebf14d60cdb2ea71ecae84470c90547aba4b5c7908da25f588eccc5eb50c4d8241700660c3d3878a34d73d962b13e495eb222ca69ebf614526b9712052ac3270bd5a364d06165a519b1096bcb7c694dca0b6fc9dafa624085a0f270b456d9fb88f57e0a9dedc5ab763b216478542f6cef01d35bdcfff8d50a45c044da5b56e113f83e3d644c6a849265bf0f76feff11709dc1da930c76dbd673d3d3bd7deb02cc0f84e46e5b0ee209c26fe0314c12471696b7f56e9b683425dbc0bf819798c415f2bc11ae8341c28b2fa971482c2bdcf274dd7f42cdeb8e0087513c8a08e763d07e081e8361815c4bb86c58f1164ff592019d866f88d26c173b2385ef14ae700e38460dcdf90560c7fa86aa2df9f4fae995f6b6e5750a24c45300b0c700f61fcf7cb021aef8465f627320224c407f4ad61b559b9bb0a77966ec321a2df28ddd9191af7bd398bbf07d3688c11c0f8e95b043286ef1f6fd5b3e909f89181476aea891";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), true);
    }
    function test_rs256_4096_e65537_6() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"94673f08882f03202fc74f27d555226f3f389967c7f30f6c7f299663e5a8306abc834fb5e1f6e9e83b9be3149472b91332d9275105f2e7731ddd1c7e796193ecb6cfd9787c5fa05514fc59a77d209568d12ffc17148afa61e4311e08a6e740c4a1a4ba80fa2207429a8a711176417ab1d5ca75d6c6112bf2800950dd0987aa27";
        bytes memory S = hex"71c315c21b8089087f695dbbab7d02c3000bfee575d922f233d718f86106bbe580953d28c573d848bf90b3e6646840e6f278f1da94223b968aa09911ee5ecf7467a1aaf7ebdcc69a97374ef80e7555989e4638c5fdc542c332d5b8ff1dd4d0e874c3b74f39fe589e190c1ad0b4ad84794ce6d741a2b76e393affff72c7a647ea9c99845871fba0814fa66514374f3b4583338ba51fcded70a39ad46659993bf3cd8ba2f92f624a5ed44e99059d1d0c4939aea8fafaf6783d281ab94ee182e63f81487b522e8bd7f5ac501626c15139bb69d4a6d221318c6b714fef2e2f1fcb7dfc63c406744f7c1f28693dfae5cead201885f47433491359af614a5d21233f8d3551549cfaeaa10998a7848be798abb89b338313ee4679afaa494933d73b08fa836036c8d7a463932b27653ca614a225aa97879f9c14a8fcca9532d1f484fe937e8936ad0c239880ca288e670cf88b29bad52bfdebfb7aa471275d7ad5d9689b742d63b9889f97f499b12578eae51f69aeddf580fb9314a93e976d4591f44a07e727f32b58852115e8e56c7ce8ae522b004c2d084b5c0477500937a13b012be15927fe66592add9ae02e2997c69beb175f368279a20d7cc9e5ffc15154ce8d59036bb2b978f842aa6d69aad64b4bddc6c56281d05e83b3a49115fe0632021895885ef6d0864ddca8cfea8c4f4a37f29c4a4847452dc89001ca6f47fb356043b2";
        bytes memory n = hex"b8d3d58b035508e4c6f1f1ee322253875ce74159f4e2d0e3ae4bca0635fae74ac5ebe0a8fd161dda64ba072ff7b1bdd9b8979ae0b1c2e702c3fe08a5a4f3b2ea6502e483c1144452f4a6fcdce08c5b3c2a495ec5892f717adb6bb13e2293a744764f885399700b5026dd8b94bf1c9cb608f9a6aa14e536df0156a54d88daa2e6722ef0c2d9ad6eca9618ca8526db102abfa5ce556a2250fb4700f82f2369cebf14d60cdb2ea71ecae84470c90547aba4b5c7908da25f588eccc5eb50c4d8241700660c3d3878a34d73d962b13e495eb222ca69ebf614526b9712052ac3270bd5a364d06165a519b1096bcb7c694dca0b6fc9dafa624085a0f270b456d9fb88f57e0a9dedc5ab763b216478542f6cef01d35bdcfff8d50a45c044da5b56e113f83e3d644c6a849265bf0f76feff11709dc1da930c76dbd673d3d3bd7deb02cc0f84e46e5b0ee209c26fe0314c12471696b7f56e9b683425dbc0bf819798c415f2bc11ae8341c28b2fa971482c2bdcf274dd7f42cdeb8e0087513c8a08e763d07e081e8361815c4bb86c58f1164ff592019d866f88d26c173b2385ef14ae700e38460dcdf90560c7fa86aa2df9f4fae995f6b6e5750a24c45300b0c700f61fcf7cb021aef8465f627320224c407f4ad61b559b9bb0a77966ec321a2df28ddd9191af7bd398bbf07d3688c11c0f8e95b043286ef1f6fd5b3e909f89181476aea891";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), false);
    }
    function test_rs256_4096_e65537_7() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"8391321c3e89d775f72744bde2b75037dc5005cb75db4664b076cade2cb640027c0c27ee26b3112d3b990d33ecdab4f1d48dbb0f01937cbdfcf91baf03b7ea1b2440e852d8282e8a612d710a748ff7edb23c4f4d47039498a96f5009ac59ec6cd8427e597b102562a9fb3fca0aabd11267639c87c926c261377403e182e17646";
        bytes memory S = hex"65e2651d9f3c631bcdf7a5538414304f2bdee9620b84f86500d3c2fa84f101fbfa65831e429d87d09584799940058f504c8ac48ddfb6221a2f84cc3513a4d4c15f33050da97f6b3ff3b5e408fd2d4ce9ab3fadd72daf0901ae5f1526ea2890cf5c444142aaac063be509b8ccb0af354106d3bc954bb627d84c4fa7ac3114cd236d65b4f0ae45071eec20ee4ba434d6a4ed5c5bc47c36ed26462335fc66cbd6b7ee01e7d0e0220dad9c9409c6fff5392f7d446c4a040316b41cb6167b3a61dc4d578117c3c2cbe7450db52af11f48fd9f8efb0ccecc101c72fe7df7134310900c810b1caf383bd8aa6561ce468e92f8cdd1ebc616c4b3fa4a6c27c7a05c421060972f6f157692aec0d3b649f688dbceeeb1f5bebfdd9f27e97b95d3d2d671fad23a232c6f25c58b902adf133d32dd110f97704cd3a57f86bc46892f89a6c53364b115d07809a7794260c70cbe0f7713be4772d57ddcd204097e71424c2280aa3aeb046927f0aa1aeaae81db4a35af65327cc7d4b6e3170efe70095509ede21544dc771573bbb969abd0a08e7d9b77066f0a947d2f8b4639a96cc1fe2673738e19d349094ae63b44f2a03288384095b3231107b15fa22c1337d5f1295867b5802a1f585d57f48f4405c843ca0f07bf804d7ab82b42ae5ed8101b075b16e0212a5411f9b6ae0c0a65a3a8e17c779637efe39e4c0096785bebe99309c6d40f7e6539";
        bytes memory n = hex"b8d3d58b035508e4c6f1f1ee322253875ce74159f4e2d0e3ae4bca0635fae74ac5ebe0a8fd161dda64ba072ff7b1bdd9b8979ae0b1c2e702c3fe08a5a4f3b2ea6502e483c1144452f4a6fcdce08c5b3c2a495ec5892f717adb6bb13e2293a744764f885399700b5026dd8b94bf1c9cb608f9a6aa14e536df0156a54d88daa2e6722ef0c2d9ad6eca9618ca8526db102abfa5ce556a2250fb4700f82f2369cebf14d60cdb2ea71ecae84470c90547aba4b5c7908da25f588eccc5eb50c4d8241700660c3d3878a34d73d962b13e495eb222ca69ebf614526b9712052ac3270bd5a364d06165a519b1096bcb7c694dca0b6fc9dafa624085a0f270b456d9fb88f57e0a9dedc5ab763b216478542f6cef01d35bdcfff8d50a45c044da5b56e113f83e3d644c6a849265bf0f76feff11709dc1da930c76dbd673d3d3bd7deb02cc0f84e46e5b0ee209c26fe0314c12471696b7f56e9b683425dbc0bf819798c415f2bc11ae8341c28b2fa971482c2bdcf274dd7f42cdeb8e0087513c8a08e763d07e081e8361815c4bb86c58f1164ff592019d866f88d26c173b2385ef14ae700e38460dcdf90560c7fa86aa2df9f4fae995f6b6e5750a24c45300b0c700f61fcf7cb021aef8465f627320224c407f4ad61b559b9bb0a77966ec321a2df28ddd9191af7bd398bbf07d3688c11c0f8e95b043286ef1f6fd5b3e909f89181476aea891";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), true);
    }
    function test_rs256_4096_e65537_8() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"8391321c3e89d775f72744bde2b75037dc5005cb75db4664b076cade2cb640027c0c27ee26b3112d3b990d33ecdab4f1d48dbb0f01937cbdfcf91baf03b7ea1b2440e852d8282e8a612d710a748ff7edb23c4f4d47039498a96f5009ac59ec6cd8427e597b102562a9fb3fca0aabd11267639c87c926c261377403e182e17646";
        bytes memory S = hex"9ae2651d9f3c631bcdf7a5538414304f2bdee9620b84f86500d3c2fa84f101fbfa65831e429d87d09584799940058f504c8ac48ddfb6221a2f84cc3513a4d4c15f33050da97f6b3ff3b5e408fd2d4ce9ab3fadd72daf0901ae5f1526ea2890cf5c444142aaac063be509b8ccb0af354106d3bc954bb627d84c4fa7ac3114cd236d65b4f0ae45071eec20ee4ba434d6a4ed5c5bc47c36ed26462335fc66cbd6b7ee01e7d0e0220dad9c9409c6fff5392f7d446c4a040316b41cb6167b3a61dc4d578117c3c2cbe7450db52af11f48fd9f8efb0ccecc101c72fe7df7134310900c810b1caf383bd8aa6561ce468e92f8cdd1ebc616c4b3fa4a6c27c7a05c421060972f6f157692aec0d3b649f688dbceeeb1f5bebfdd9f27e97b95d3d2d671fad23a232c6f25c58b902adf133d32dd110f97704cd3a57f86bc46892f89a6c53364b115d07809a7794260c70cbe0f7713be4772d57ddcd204097e71424c2280aa3aeb046927f0aa1aeaae81db4a35af65327cc7d4b6e3170efe70095509ede21544dc771573bbb969abd0a08e7d9b77066f0a947d2f8b4639a96cc1fe2673738e19d349094ae63b44f2a03288384095b3231107b15fa22c1337d5f1295867b5802a1f585d57f48f4405c843ca0f07bf804d7ab82b42ae5ed8101b075b16e0212a5411f9b6ae0c0a65a3a8e17c779637efe39e4c0096785bebe99309c6d40f7e6539";
        bytes memory n = hex"b8d3d58b035508e4c6f1f1ee322253875ce74159f4e2d0e3ae4bca0635fae74ac5ebe0a8fd161dda64ba072ff7b1bdd9b8979ae0b1c2e702c3fe08a5a4f3b2ea6502e483c1144452f4a6fcdce08c5b3c2a495ec5892f717adb6bb13e2293a744764f885399700b5026dd8b94bf1c9cb608f9a6aa14e536df0156a54d88daa2e6722ef0c2d9ad6eca9618ca8526db102abfa5ce556a2250fb4700f82f2369cebf14d60cdb2ea71ecae84470c90547aba4b5c7908da25f588eccc5eb50c4d8241700660c3d3878a34d73d962b13e495eb222ca69ebf614526b9712052ac3270bd5a364d06165a519b1096bcb7c694dca0b6fc9dafa624085a0f270b456d9fb88f57e0a9dedc5ab763b216478542f6cef01d35bdcfff8d50a45c044da5b56e113f83e3d644c6a849265bf0f76feff11709dc1da930c76dbd673d3d3bd7deb02cc0f84e46e5b0ee209c26fe0314c12471696b7f56e9b683425dbc0bf819798c415f2bc11ae8341c28b2fa971482c2bdcf274dd7f42cdeb8e0087513c8a08e763d07e081e8361815c4bb86c58f1164ff592019d866f88d26c173b2385ef14ae700e38460dcdf90560c7fa86aa2df9f4fae995f6b6e5750a24c45300b0c700f61fcf7cb021aef8465f627320224c407f4ad61b559b9bb0a77966ec321a2df28ddd9191af7bd398bbf07d3688c11c0f8e95b043286ef1f6fd5b3e909f89181476aea891";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), false);
    }
    function test_rs256_4096_e65537_9() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"69938f4f4baea2cc778636e2431284e76c9b7e670e1e320607396af27fe4c822edaeacf2acd0293aadedb695a181d2b2fcd52ed14c650c04c9272a34b21c566df5e07950e889c53acfb1c241318cadf54ed39ca20ffb6a19be4e9ddca7c4a28bd55f0638834f035002b2754c37a3188b31b0f4b8286304e63c3364c955521068";
        bytes memory S = hex"87b10941afac256ee2a9bb8e29f07d7b6e0efe31a3a11b283efcbb894e45724cb0776b33d46cfc0ed8cac5b59d5365c737f342e2cd4037403ed6b76b2e3fca8222fad4309eb01c34b8f51d529035aaf30e22f273332bd489e0ed915f776e6b5de7d1628f4c89ba371d0b967031c09544c91036ad4f9e2aa64819bd78758e9a89354c32cdc55663152ee9ee653c31f0d086c23909a3f77465a22f8f26a41d2aa17fbea49a9dcdc3ed24780a420d3241b086a3ccbe8cff92da4793aa579516e3a37a5ee55305841fc29055acab228641e1dedbe6f6d8fe76d91eed24f028cd9f01a1bc35005fecd0622b3943f68ad6d3a44fd531071801235a3f2f0bce9ebb71b3b07fbcece0869c27c73ad7b39b6846aa1973dc3967e9af9d7fbe5df1c894ba87976719ffb180c84c19f0dace0ca935fec71ea8d90ef8dc6110cc1096e7d0ee6fd6a7030a3050654350be868a98e6f39ddb5dd00450ead7487a7087d43d6bce43d7919cfadf6e74d585ed886f3a687960bd2e10e677ff0601be84ee59f7fb1eb1210b770f9dbe57371042879040bfbf9587bfc0a03b50fc2d548b896e08d5e44de93269a77736e737e9ed95ffc45bb6de358aa7cfe5f19e7fc410997e64525ef267db9befe059303dacf77d9eb5d0ec6c10c40d3ba7970fc15ab42c4bf951b126fff4f6d97e4ff294e67292a6fd41daf5eb55820da0317911b19ab75b4c3fe65a";
        bytes memory n = hex"b8d3d58b035508e4c6f1f1ee322253875ce74159f4e2d0e3ae4bca0635fae74ac5ebe0a8fd161dda64ba072ff7b1bdd9b8979ae0b1c2e702c3fe08a5a4f3b2ea6502e483c1144452f4a6fcdce08c5b3c2a495ec5892f717adb6bb13e2293a744764f885399700b5026dd8b94bf1c9cb608f9a6aa14e536df0156a54d88daa2e6722ef0c2d9ad6eca9618ca8526db102abfa5ce556a2250fb4700f82f2369cebf14d60cdb2ea71ecae84470c90547aba4b5c7908da25f588eccc5eb50c4d8241700660c3d3878a34d73d962b13e495eb222ca69ebf614526b9712052ac3270bd5a364d06165a519b1096bcb7c694dca0b6fc9dafa624085a0f270b456d9fb88f57e0a9dedc5ab763b216478542f6cef01d35bdcfff8d50a45c044da5b56e113f83e3d644c6a849265bf0f76feff11709dc1da930c76dbd673d3d3bd7deb02cc0f84e46e5b0ee209c26fe0314c12471696b7f56e9b683425dbc0bf819798c415f2bc11ae8341c28b2fa971482c2bdcf274dd7f42cdeb8e0087513c8a08e763d07e081e8361815c4bb86c58f1164ff592019d866f88d26c173b2385ef14ae700e38460dcdf90560c7fa86aa2df9f4fae995f6b6e5750a24c45300b0c700f61fcf7cb021aef8465f627320224c407f4ad61b559b9bb0a77966ec321a2df28ddd9191af7bd398bbf07d3688c11c0f8e95b043286ef1f6fd5b3e909f89181476aea891";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), true);
    }
    function test_rs256_4096_e65537_10() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000010001";
        bytes memory Msg = hex"69938f4f4baea2cc778636e2431284e76c9b7e670e1e320607396af27fe4c822edaeacf2acd0293aadedb695a181d2b2fcd52ed14c650c04c9272a34b21c566df5e07950e889c53acfb1c241318cadf54ed39ca20ffb6a19be4e9ddca7c4a28bd55f0638834f035002b2754c37a3188b31b0f4b8286304e63c3364c955521068";
        bytes memory S = hex"78b10941afac256ee2a9bb8e29f07d7b6e0efe31a3a11b283efcbb894e45724cb0776b33d46cfc0ed8cac5b59d5365c737f342e2cd4037403ed6b76b2e3fca8222fad4309eb01c34b8f51d529035aaf30e22f273332bd489e0ed915f776e6b5de7d1628f4c89ba371d0b967031c09544c91036ad4f9e2aa64819bd78758e9a89354c32cdc55663152ee9ee653c31f0d086c23909a3f77465a22f8f26a41d2aa17fbea49a9dcdc3ed24780a420d3241b086a3ccbe8cff92da4793aa579516e3a37a5ee55305841fc29055acab228641e1dedbe6f6d8fe76d91eed24f028cd9f01a1bc35005fecd0622b3943f68ad6d3a44fd531071801235a3f2f0bce9ebb71b3b07fbcece0869c27c73ad7b39b6846aa1973dc3967e9af9d7fbe5df1c894ba87976719ffb180c84c19f0dace0ca935fec71ea8d90ef8dc6110cc1096e7d0ee6fd6a7030a3050654350be868a98e6f39ddb5dd00450ead7487a7087d43d6bce43d7919cfadf6e74d585ed886f3a687960bd2e10e677ff0601be84ee59f7fb1eb1210b770f9dbe57371042879040bfbf9587bfc0a03b50fc2d548b896e08d5e44de93269a77736e737e9ed95ffc45bb6de358aa7cfe5f19e7fc410997e64525ef267db9befe059303dacf77d9eb5d0ec6c10c40d3ba7970fc15ab42c4bf951b126fff4f6d97e4ff294e67292a6fd41daf5eb55820da0317911b19ab75b4c3fe65a";
        bytes memory n = hex"b8d3d58b035508e4c6f1f1ee322253875ce74159f4e2d0e3ae4bca0635fae74ac5ebe0a8fd161dda64ba072ff7b1bdd9b8979ae0b1c2e702c3fe08a5a4f3b2ea6502e483c1144452f4a6fcdce08c5b3c2a495ec5892f717adb6bb13e2293a744764f885399700b5026dd8b94bf1c9cb608f9a6aa14e536df0156a54d88daa2e6722ef0c2d9ad6eca9618ca8526db102abfa5ce556a2250fb4700f82f2369cebf14d60cdb2ea71ecae84470c90547aba4b5c7908da25f588eccc5eb50c4d8241700660c3d3878a34d73d962b13e495eb222ca69ebf614526b9712052ac3270bd5a364d06165a519b1096bcb7c694dca0b6fc9dafa624085a0f270b456d9fb88f57e0a9dedc5ab763b216478542f6cef01d35bdcfff8d50a45c044da5b56e113f83e3d644c6a849265bf0f76feff11709dc1da930c76dbd673d3d3bd7deb02cc0f84e46e5b0ee209c26fe0314c12471696b7f56e9b683425dbc0bf819798c415f2bc11ae8341c28b2fa971482c2bdcf274dd7f42cdeb8e0087513c8a08e763d07e081e8361815c4bb86c58f1164ff592019d866f88d26c173b2385ef14ae700e38460dcdf90560c7fa86aa2df9f4fae995f6b6e5750a24c45300b0c700f61fcf7cb021aef8465f627320224c407f4ad61b559b9bb0a77966ec321a2df28ddd9191af7bd398bbf07d3688c11c0f8e95b043286ef1f6fd5b3e909f89181476aea891";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), false);
    }
}