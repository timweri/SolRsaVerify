// SPDX-License-Identifier: UNLICENSED

pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import "../src/RsaVerifyOptimized.sol";

contract RsaVerifyOptimized_2048_e3Test is Test {
    function test_rs256_2048_e3_1() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000000003";
        bytes memory Msg = hex"398c2bb6efb7f0455c13c2489875cb849cf9e313f8692c919a1674e4f368099598acf4f1714f49696b3d88743bc089dd411b02c50a58dfeed4d56935d62b36c87d8db7c83b983d8fc0f61187e163a943e2afae335c0cca729a49b3a73914e89ac5c73401b9b64455c5f529fa06d139e81bfdd15ddc7473974e1e03fdb3ba26c8";
        bytes memory S = hex"609da74009594c3ab078749cafdba24e087eb6a69c001d158d04e152e80019e97f228485453022f84145c355287db8d8169ac5de59061c1fb71a0a762f79981d733b3aecec9ac27076dd2c994c4b076450701a76db02b5c54d896bee4b813267030f83351718153765b324bcfb4218cc09d5b18a451d2d15f9746aa2f0a937a3a87b6c36ccb1f05029b0a762e77b36625121c5f07209faa9149eedf9ae988f52863bb5d57c22e2bb36c6ed2f719736a1b449b4e0b60d7e614a2d86af33838f20eaa756302cadc6cd3771c133827c528f0b0b8191866b18450222b23c0563a1aef381748bfa045716c32df5f4e1d4e54bb509e70d7851c17dc240455df1310903";
        bytes memory n = hex"d44fb8b2f13066b7003b6fd2e513ba5041bdca2a061860d28c3065ccf11be316d96a89748c520746e2e22f1fda63fca9b9179f4b42612bf3ef1065921e205f019b0184fca9ec865b8ca03350a25969fa1553f5976fcdc62dfd37094cde373ccc33a39a4ff4de772e2c1578354bd7af9ff2f7bbb0578b84042c51e67ce377dfe02b5326cfa68bcafad23a6e347be73036ec0c8e91d2229b64351d35b0ab8b01625cb6c5755aa57df717b6e0d1b65dcbdcf0206de3cc9d497cf1084b59b8c996c0614dfe4784aec4ed794feb0d3d58868c411678c8b4aca76fc6383371e5b8944a8c22c0ea6292411e29d8179b92a4e435e6a8f52daf9e3141e579c1900cf9b46f";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), true);
    }
    function test_rs256_2048_e3_2() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000000003";
        bytes memory Msg = hex"398c2bb6efb7f0455c13c2489875cb849cf9e313f8692c919a1674e4f368099598acf4f1714f49696b3d88743bc089dd411b02c50a58dfeed4d56935d62b36c87d8db7c83b983d8fc0f61187e163a943e2afae335c0cca729a49b3a73914e89ac5c73401b9b64455c5f529fa06d139e81bfdd15ddc7473974e1e03fdb3ba26c8";
        bytes memory S = hex"9f9da74009594c3ab078749cafdba24e087eb6a69c001d158d04e152e80019e97f228485453022f84145c355287db8d8169ac5de59061c1fb71a0a762f79981d733b3aecec9ac27076dd2c994c4b076450701a76db02b5c54d896bee4b813267030f83351718153765b324bcfb4218cc09d5b18a451d2d15f9746aa2f0a937a3a87b6c36ccb1f05029b0a762e77b36625121c5f07209faa9149eedf9ae988f52863bb5d57c22e2bb36c6ed2f719736a1b449b4e0b60d7e614a2d86af33838f20eaa756302cadc6cd3771c133827c528f0b0b8191866b18450222b23c0563a1aef381748bfa045716c32df5f4e1d4e54bb509e70d7851c17dc240455df1310903";
        bytes memory n = hex"d44fb8b2f13066b7003b6fd2e513ba5041bdca2a061860d28c3065ccf11be316d96a89748c520746e2e22f1fda63fca9b9179f4b42612bf3ef1065921e205f019b0184fca9ec865b8ca03350a25969fa1553f5976fcdc62dfd37094cde373ccc33a39a4ff4de772e2c1578354bd7af9ff2f7bbb0578b84042c51e67ce377dfe02b5326cfa68bcafad23a6e347be73036ec0c8e91d2229b64351d35b0ab8b01625cb6c5755aa57df717b6e0d1b65dcbdcf0206de3cc9d497cf1084b59b8c996c0614dfe4784aec4ed794feb0d3d58868c411678c8b4aca76fc6383371e5b8944a8c22c0ea6292411e29d8179b92a4e435e6a8f52daf9e3141e579c1900cf9b46f";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), false);
    }
    function test_rs256_2048_e3_3() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000000003";
        bytes memory Msg = hex"0ec99fe90f3c2e4dd49eada5fc071367930df126d39657aa466aeafc5665f9a5a584ce0f694f3d63d1a87427167d868f0fd0362b36e61ac2d1c51d2ba63acf52e00381aa5e354d954cb1fcc9702ae2328ed205dd0b9caf4cb2f679b9f307b2e48f29b1a886579d4a7a85ee32bebd733ecbcf4e6068edff23931f9d74229bd6c5";
        bytes memory S = hex"243e0f415555dcbc05620c075f997b0aa639a7c6e9b3b8dced78760d833ea7027326b945374817c155902c9682c64854d20d711fc9993cde25516c63118ecf38cd48237acc996ae8f220f759de0d1f851e1b97d27d9da32afa808aec95cb15d0f6b83e95a83009bfa877535d3c78d785593deb1baa25e8d76c56f5215b6f87149b10e210c749861337d06c58948e1ec9f4d88d9d6f023129802fc6435ff8981be38e806ca823f724367de508288d2eb61ce73e66aa884ca7358066dce693d41eb3c50e2f887ada6b71abaff72a76c749306c5c60b06971761dda8d3433410608df459b5c089e70d1b95aeac2ffd8070794691e97a30e1e780ed3a32c05989fa9";
        bytes memory n = hex"d44fb8b2f13066b7003b6fd2e513ba5041bdca2a061860d28c3065ccf11be316d96a89748c520746e2e22f1fda63fca9b9179f4b42612bf3ef1065921e205f019b0184fca9ec865b8ca03350a25969fa1553f5976fcdc62dfd37094cde373ccc33a39a4ff4de772e2c1578354bd7af9ff2f7bbb0578b84042c51e67ce377dfe02b5326cfa68bcafad23a6e347be73036ec0c8e91d2229b64351d35b0ab8b01625cb6c5755aa57df717b6e0d1b65dcbdcf0206de3cc9d497cf1084b59b8c996c0614dfe4784aec4ed794feb0d3d58868c411678c8b4aca76fc6383371e5b8944a8c22c0ea6292411e29d8179b92a4e435e6a8f52daf9e3141e579c1900cf9b46f";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), true);
    }
    function test_rs256_2048_e3_4() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000000003";
        bytes memory Msg = hex"0ec99fe90f3c2e4dd49eada5fc071367930df126d39657aa466aeafc5665f9a5a584ce0f694f3d63d1a87427167d868f0fd0362b36e61ac2d1c51d2ba63acf52e00381aa5e354d954cb1fcc9702ae2328ed205dd0b9caf4cb2f679b9f307b2e48f29b1a886579d4a7a85ee32bebd733ecbcf4e6068edff23931f9d74229bd6c5";
        bytes memory S = hex"db3e0f415555dcbc05620c075f997b0aa639a7c6e9b3b8dced78760d833ea7027326b945374817c155902c9682c64854d20d711fc9993cde25516c63118ecf38cd48237acc996ae8f220f759de0d1f851e1b97d27d9da32afa808aec95cb15d0f6b83e95a83009bfa877535d3c78d785593deb1baa25e8d76c56f5215b6f87149b10e210c749861337d06c58948e1ec9f4d88d9d6f023129802fc6435ff8981be38e806ca823f724367de508288d2eb61ce73e66aa884ca7358066dce693d41eb3c50e2f887ada6b71abaff72a76c749306c5c60b06971761dda8d3433410608df459b5c089e70d1b95aeac2ffd8070794691e97a30e1e780ed3a32c05989fa9";
        bytes memory n = hex"d44fb8b2f13066b7003b6fd2e513ba5041bdca2a061860d28c3065ccf11be316d96a89748c520746e2e22f1fda63fca9b9179f4b42612bf3ef1065921e205f019b0184fca9ec865b8ca03350a25969fa1553f5976fcdc62dfd37094cde373ccc33a39a4ff4de772e2c1578354bd7af9ff2f7bbb0578b84042c51e67ce377dfe02b5326cfa68bcafad23a6e347be73036ec0c8e91d2229b64351d35b0ab8b01625cb6c5755aa57df717b6e0d1b65dcbdcf0206de3cc9d497cf1084b59b8c996c0614dfe4784aec4ed794feb0d3d58868c411678c8b4aca76fc6383371e5b8944a8c22c0ea6292411e29d8179b92a4e435e6a8f52daf9e3141e579c1900cf9b46f";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), false);
    }
    function test_rs256_2048_e3_5() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000000003";
        bytes memory Msg = hex"94673f08882f03202fc74f27d555226f3f389967c7f30f6c7f299663e5a8306abc834fb5e1f6e9e83b9be3149472b91332d9275105f2e7731ddd1c7e796193ecb6cfd9787c5fa05514fc59a77d209568d12ffc17148afa61e4311e08a6e740c4a1a4ba80fa2207429a8a711176417ab1d5ca75d6c6112bf2800950dd0987aa27";
        bytes memory S = hex"8a87ee3e2ee31885c213391e677d2e0f3544957529bab58dfa7602334d5866f1ac3596e1272e4a4c1960865a6c9d555bb19e2cd53c0e3980f1a40e4f510c383963081dbbb5568a43412a7216b57d7531f1a964df38d0d5cb7515b208ab6ea241ab6ba761f8dd767d2982160927e7edb7966d405a60f07257cb066d7212422688dfea58acbf241831a27a90121265c1984555214d90fdf3b003b16f6f5da0a1a903abaa2a845ee7effe78a669b75fc3ae12c94504afb2aead5471d943d382df0c7a53270bbc062e50698c146cc78d2c109e820ce76c0c4dcc40924c7db4200907d648d4c1ed233ec143334137d7eb857a34fec070a884623c3a733d266393aaae";
        bytes memory n = hex"d44fb8b2f13066b7003b6fd2e513ba5041bdca2a061860d28c3065ccf11be316d96a89748c520746e2e22f1fda63fca9b9179f4b42612bf3ef1065921e205f019b0184fca9ec865b8ca03350a25969fa1553f5976fcdc62dfd37094cde373ccc33a39a4ff4de772e2c1578354bd7af9ff2f7bbb0578b84042c51e67ce377dfe02b5326cfa68bcafad23a6e347be73036ec0c8e91d2229b64351d35b0ab8b01625cb6c5755aa57df717b6e0d1b65dcbdcf0206de3cc9d497cf1084b59b8c996c0614dfe4784aec4ed794feb0d3d58868c411678c8b4aca76fc6383371e5b8944a8c22c0ea6292411e29d8179b92a4e435e6a8f52daf9e3141e579c1900cf9b46f";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), true);
    }
    function test_rs256_2048_e3_6() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000000003";
        bytes memory Msg = hex"94673f08882f03202fc74f27d555226f3f389967c7f30f6c7f299663e5a8306abc834fb5e1f6e9e83b9be3149472b91332d9275105f2e7731ddd1c7e796193ecb6cfd9787c5fa05514fc59a77d209568d12ffc17148afa61e4311e08a6e740c4a1a4ba80fa2207429a8a711176417ab1d5ca75d6c6112bf2800950dd0987aa27";
        bytes memory S = hex"7587ee3e2ee31885c213391e677d2e0f3544957529bab58dfa7602334d5866f1ac3596e1272e4a4c1960865a6c9d555bb19e2cd53c0e3980f1a40e4f510c383963081dbbb5568a43412a7216b57d7531f1a964df38d0d5cb7515b208ab6ea241ab6ba761f8dd767d2982160927e7edb7966d405a60f07257cb066d7212422688dfea58acbf241831a27a90121265c1984555214d90fdf3b003b16f6f5da0a1a903abaa2a845ee7effe78a669b75fc3ae12c94504afb2aead5471d943d382df0c7a53270bbc062e50698c146cc78d2c109e820ce76c0c4dcc40924c7db4200907d648d4c1ed233ec143334137d7eb857a34fec070a884623c3a733d266393aaae";
        bytes memory n = hex"d44fb8b2f13066b7003b6fd2e513ba5041bdca2a061860d28c3065ccf11be316d96a89748c520746e2e22f1fda63fca9b9179f4b42612bf3ef1065921e205f019b0184fca9ec865b8ca03350a25969fa1553f5976fcdc62dfd37094cde373ccc33a39a4ff4de772e2c1578354bd7af9ff2f7bbb0578b84042c51e67ce377dfe02b5326cfa68bcafad23a6e347be73036ec0c8e91d2229b64351d35b0ab8b01625cb6c5755aa57df717b6e0d1b65dcbdcf0206de3cc9d497cf1084b59b8c996c0614dfe4784aec4ed794feb0d3d58868c411678c8b4aca76fc6383371e5b8944a8c22c0ea6292411e29d8179b92a4e435e6a8f52daf9e3141e579c1900cf9b46f";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), false);
    }
    function test_rs256_2048_e3_7() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000000003";
        bytes memory Msg = hex"8391321c3e89d775f72744bde2b75037dc5005cb75db4664b076cade2cb640027c0c27ee26b3112d3b990d33ecdab4f1d48dbb0f01937cbdfcf91baf03b7ea1b2440e852d8282e8a612d710a748ff7edb23c4f4d47039498a96f5009ac59ec6cd8427e597b102562a9fb3fca0aabd11267639c87c926c261377403e182e17646";
        bytes memory S = hex"88d6b27bf08149d853f9d65feca8543c11ac25cb6f950a00874350720d5c5e59aab10aac7192098f0effa74d94f4d82e501aaca027f0264a044d71c56e73276ca0d5bb6414209dfb8275516599dba50e538355978afc9298d6a2db66412a744f9026b5c76f78255c30708f161ab23ed27348e9360d189c09a3669e6701e58ab2c533e512d13ef1ca52ba8f5cd5f2a0ac7976bac71d15e0a122891dc03f93f3704d2a0f732da099513ee21846f529d7d1acd7bcfc3b414bb54bc02b91eec50ef15a5a2ab574c61a498f449ee0fc8126b6d14262487db76eb6c5b7843c9c1965ec6328542e9579b8ca44ed2ae70e34242b58166ddb8e6444064ceb46bc100f3a00";
        bytes memory n = hex"d44fb8b2f13066b7003b6fd2e513ba5041bdca2a061860d28c3065ccf11be316d96a89748c520746e2e22f1fda63fca9b9179f4b42612bf3ef1065921e205f019b0184fca9ec865b8ca03350a25969fa1553f5976fcdc62dfd37094cde373ccc33a39a4ff4de772e2c1578354bd7af9ff2f7bbb0578b84042c51e67ce377dfe02b5326cfa68bcafad23a6e347be73036ec0c8e91d2229b64351d35b0ab8b01625cb6c5755aa57df717b6e0d1b65dcbdcf0206de3cc9d497cf1084b59b8c996c0614dfe4784aec4ed794feb0d3d58868c411678c8b4aca76fc6383371e5b8944a8c22c0ea6292411e29d8179b92a4e435e6a8f52daf9e3141e579c1900cf9b46f";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), true);
    }
    function test_rs256_2048_e3_8() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000000003";
        bytes memory Msg = hex"8391321c3e89d775f72744bde2b75037dc5005cb75db4664b076cade2cb640027c0c27ee26b3112d3b990d33ecdab4f1d48dbb0f01937cbdfcf91baf03b7ea1b2440e852d8282e8a612d710a748ff7edb23c4f4d47039498a96f5009ac59ec6cd8427e597b102562a9fb3fca0aabd11267639c87c926c261377403e182e17646";
        bytes memory S = hex"77d6b27bf08149d853f9d65feca8543c11ac25cb6f950a00874350720d5c5e59aab10aac7192098f0effa74d94f4d82e501aaca027f0264a044d71c56e73276ca0d5bb6414209dfb8275516599dba50e538355978afc9298d6a2db66412a744f9026b5c76f78255c30708f161ab23ed27348e9360d189c09a3669e6701e58ab2c533e512d13ef1ca52ba8f5cd5f2a0ac7976bac71d15e0a122891dc03f93f3704d2a0f732da099513ee21846f529d7d1acd7bcfc3b414bb54bc02b91eec50ef15a5a2ab574c61a498f449ee0fc8126b6d14262487db76eb6c5b7843c9c1965ec6328542e9579b8ca44ed2ae70e34242b58166ddb8e6444064ceb46bc100f3a00";
        bytes memory n = hex"d44fb8b2f13066b7003b6fd2e513ba5041bdca2a061860d28c3065ccf11be316d96a89748c520746e2e22f1fda63fca9b9179f4b42612bf3ef1065921e205f019b0184fca9ec865b8ca03350a25969fa1553f5976fcdc62dfd37094cde373ccc33a39a4ff4de772e2c1578354bd7af9ff2f7bbb0578b84042c51e67ce377dfe02b5326cfa68bcafad23a6e347be73036ec0c8e91d2229b64351d35b0ab8b01625cb6c5755aa57df717b6e0d1b65dcbdcf0206de3cc9d497cf1084b59b8c996c0614dfe4784aec4ed794feb0d3d58868c411678c8b4aca76fc6383371e5b8944a8c22c0ea6292411e29d8179b92a4e435e6a8f52daf9e3141e579c1900cf9b46f";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), false);
    }
    function test_rs256_2048_e3_9() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000000003";
        bytes memory Msg = hex"69938f4f4baea2cc778636e2431284e76c9b7e670e1e320607396af27fe4c822edaeacf2acd0293aadedb695a181d2b2fcd52ed14c650c04c9272a34b21c566df5e07950e889c53acfb1c241318cadf54ed39ca20ffb6a19be4e9ddca7c4a28bd55f0638834f035002b2754c37a3188b31b0f4b8286304e63c3364c955521068";
        bytes memory S = hex"81f5712ddcd9fd1bd2bb8d6ee47bdf77658a8c912aa65a13772237ff4bfe75d9a8fe5bc48625991d9b0c1c9534969d4df6773c565729327be100554f17c596a6b8c6d58f661d8595f15a8248abbd86f36143867cd192b09f3def467bfa07885c8be7b24e378dbb41d751baf40d35b38f9d16b3462aa1891dbd4e2a84d2b17c80433fca91bf6092bdb433b88387fa6cd487f76cf66a2ada30c112e2ade7b44cedaf1369764fbb7bf6a0461a579122a97e0d2674a71b9f575d6da0589891e7d333cf28feefa5972f297eabb9a357623ab2587d408329adc590c5cf328e9d92dae373380b313c532dbce17810085e3a96bacab9fc6e1a33cb537ba56dbff56da1ad";
        bytes memory n = hex"d44fb8b2f13066b7003b6fd2e513ba5041bdca2a061860d28c3065ccf11be316d96a89748c520746e2e22f1fda63fca9b9179f4b42612bf3ef1065921e205f019b0184fca9ec865b8ca03350a25969fa1553f5976fcdc62dfd37094cde373ccc33a39a4ff4de772e2c1578354bd7af9ff2f7bbb0578b84042c51e67ce377dfe02b5326cfa68bcafad23a6e347be73036ec0c8e91d2229b64351d35b0ab8b01625cb6c5755aa57df717b6e0d1b65dcbdcf0206de3cc9d497cf1084b59b8c996c0614dfe4784aec4ed794feb0d3d58868c411678c8b4aca76fc6383371e5b8944a8c22c0ea6292411e29d8179b92a4e435e6a8f52daf9e3141e579c1900cf9b46f";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), true);
    }
    function test_rs256_2048_e3_10() public {
        bytes memory e = hex"0000000000000000000000000000000000000000000000000000000000000000000003";
        bytes memory Msg = hex"69938f4f4baea2cc778636e2431284e76c9b7e670e1e320607396af27fe4c822edaeacf2acd0293aadedb695a181d2b2fcd52ed14c650c04c9272a34b21c566df5e07950e889c53acfb1c241318cadf54ed39ca20ffb6a19be4e9ddca7c4a28bd55f0638834f035002b2754c37a3188b31b0f4b8286304e63c3364c955521068";
        bytes memory S = hex"7ef5712ddcd9fd1bd2bb8d6ee47bdf77658a8c912aa65a13772237ff4bfe75d9a8fe5bc48625991d9b0c1c9534969d4df6773c565729327be100554f17c596a6b8c6d58f661d8595f15a8248abbd86f36143867cd192b09f3def467bfa07885c8be7b24e378dbb41d751baf40d35b38f9d16b3462aa1891dbd4e2a84d2b17c80433fca91bf6092bdb433b88387fa6cd487f76cf66a2ada30c112e2ade7b44cedaf1369764fbb7bf6a0461a579122a97e0d2674a71b9f575d6da0589891e7d333cf28feefa5972f297eabb9a357623ab2587d408329adc590c5cf328e9d92dae373380b313c532dbce17810085e3a96bacab9fc6e1a33cb537ba56dbff56da1ad";
        bytes memory n = hex"d44fb8b2f13066b7003b6fd2e513ba5041bdca2a061860d28c3065ccf11be316d96a89748c520746e2e22f1fda63fca9b9179f4b42612bf3ef1065921e205f019b0184fca9ec865b8ca03350a25969fa1553f5976fcdc62dfd37094cde373ccc33a39a4ff4de772e2c1578354bd7af9ff2f7bbb0578b84042c51e67ce377dfe02b5326cfa68bcafad23a6e347be73036ec0c8e91d2229b64351d35b0ab8b01625cb6c5755aa57df717b6e0d1b65dcbdcf0206de3cc9d497cf1084b59b8c996c0614dfe4784aec4ed794feb0d3d58868c411678c8b4aca76fc6383371e5b8944a8c22c0ea6292411e29d8179b92a4e435e6a8f52daf9e3141e579c1900cf9b46f";
        assertEq(RsaVerifyOptimized.pkcs1Sha256Raw(Msg, S, e, n), false);
    }
}